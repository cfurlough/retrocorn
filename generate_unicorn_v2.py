"""
Generate proper unicorn sprites with clear unicorn features:
- Horse-like body proportions
- Distinctive spiral horn
- Flowing mane and tail
- Four legs
- Cute eye
"""

from PIL import Image, ImageDraw
import os

# Output size (will be scaled up 4x from 32x32 base)
BASE_SIZE = 32
SCALE = 4
OUTPUT_SIZE = BASE_SIZE * SCALE

def create_unicorn_frame(variant, frame_data, base_size=32):
    """Create a single unicorn frame from pixel data"""
    img = Image.new('RGBA', (base_size, base_size), (0, 0, 0, 0))
    pixels = img.load()

    palette = frame_data['palette']
    pixel_data = frame_data['pixels']

    for y, row in enumerate(pixel_data):
        if y >= base_size:
            break
        for x, char in enumerate(row):
            if x >= base_size:
                break
            if char in palette:
                pixels[x, y] = palette[char]

    # Scale up 4x with nearest neighbor for pixel art look
    return img.resize((base_size * SCALE, base_size * SCALE), Image.NEAREST)

def get_unicorn_palettes():
    """Get color palettes for different unicorn variants"""
    return {
        'white': {
            'B': (255, 255, 255, 255),      # Body white
            'b': (230, 230, 240, 255),      # Body shadow
            'H': (255, 215, 0, 255),        # Horn gold
            'h': (218, 165, 32, 255),       # Horn shadow
            'M': (200, 200, 220, 255),      # Mane light
            'm': (170, 170, 200, 255),      # Mane mid
            'T': (150, 150, 180, 255),      # Tail
            'E': (40, 40, 60, 255),         # Eye
            'e': (80, 80, 120, 255),        # Eye highlight
            'P': (255, 200, 200, 255),      # Pink nose/cheek
            'L': (220, 220, 230, 255),      # Leg highlight
            'l': (180, 180, 200, 255),      # Leg shadow
            'O': (60, 60, 80, 255),         # Outline
            'o': (100, 100, 120, 255),      # Soft outline
        },
        'pink': {
            'B': (255, 182, 193, 255),      # Body pink
            'b': (255, 150, 170, 255),      # Body shadow
            'H': (255, 105, 180, 255),      # Horn hot pink
            'h': (219, 80, 150, 255),       # Horn shadow
            'M': (255, 130, 180, 255),      # Mane light
            'm': (255, 100, 150, 255),      # Mane mid
            'T': (255, 80, 130, 255),       # Tail
            'E': (80, 40, 80, 255),         # Eye
            'e': (120, 80, 120, 255),       # Eye highlight
            'P': (255, 220, 230, 255),      # Pink nose/cheek
            'L': (255, 170, 190, 255),      # Leg highlight
            'l': (255, 140, 170, 255),      # Leg shadow
            'O': (150, 80, 100, 255),       # Outline
            'o': (180, 100, 130, 255),      # Soft outline
        },
        'rainbow': {
            'B': (255, 255, 255, 255),      # Body white
            'b': (240, 240, 255, 255),      # Body shadow
            'H': (255, 255, 100, 255),      # Horn yellow
            'h': (255, 200, 50, 255),       # Horn shadow
            'M': (255, 100, 100, 255),      # Mane red
            'm': (255, 165, 0, 255),        # Mane orange
            'T': (100, 200, 255, 255),      # Tail cyan
            'E': (50, 50, 80, 255),         # Eye
            'e': (100, 100, 150, 255),      # Eye highlight
            'P': (255, 200, 200, 255),      # Pink cheek
            'L': (230, 230, 255, 255),      # Leg highlight
            'l': (200, 200, 230, 255),      # Leg shadow
            'O': (80, 80, 120, 255),        # Outline
            'o': (120, 120, 160, 255),      # Soft outline
            # Extra rainbow colors for mane
            'R': (255, 80, 80, 255),        # Red
            'G': (80, 255, 80, 255),        # Green
            'Y': (255, 255, 80, 255),       # Yellow
            'C': (80, 255, 255, 255),       # Cyan
            'V': (200, 100, 255, 255),      # Violet
        }
    }

def get_idle_frames(variant):
    """Get idle animation frames - gentle breathing motion"""
    palette = get_unicorn_palettes()[variant]

    # Frame 1 - normal stance
    frame1 = {
        'palette': palette,
        'pixels': [
            "................................",
            "................................",
            "................................",
            "...........Hh...................",
            "..........HHhh..................",
            ".........HHHhh..................",
            "........mMHHhBBBo...............",
            ".......mMMM.BBBBBBo.............",
            "......mMMM.BBBBBBBBo............",
            ".....mMMM.oBBBEeBBBo............",
            "....mMMM..oBBBBBBBBBo...........",
            "....MMM...oBBBPBBBBBBo..........",
            "...MMM....oBBBBBBBBBBBo.........",
            "...MM.....oBBBBBBBBBBBBo........",
            "..........oBBBBBBBBBBBBBo.......",
            "..........oBbBBBBBBBBBBBBo......",
            "..........obBBBBBBBBBBBBTTT.....",
            "...........bBBBBBBBBBBBTTTT.....",
            "...........bBBBBBBBBBBTTTT......",
            "...........bBBbBBBBbBBTTT.......",
            "...........oLloooooLlo..........",
            "...........oLl.....Llo..........",
            "...........oLl.....Llo..........",
            "...........olo.....olo..........",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
        ]
    }

    # Frame 2 - slight body raise (breathing in)
    frame2 = {
        'palette': palette,
        'pixels': [
            "................................",
            "................................",
            "...........Hh...................",
            "..........HHhh..................",
            ".........HHHhh..................",
            "........mMHHhBBBo...............",
            ".......mMMM.BBBBBBo.............",
            "......mMMM.BBBBBBBBo............",
            ".....mMMM.oBBBEeBBBo............",
            "....mMMM..oBBBBBBBBBo...........",
            "....MMM...oBBBPBBBBBBo..........",
            "...MMM....oBBBBBBBBBBBo.........",
            "...MM.....oBBBBBBBBBBBBo........",
            "..........oBBBBBBBBBBBBBo.......",
            "..........oBbBBBBBBBBBBBBo......",
            "..........obBBBBBBBBBBBBTTT.....",
            "...........bBBBBBBBBBBBTTTT.....",
            "...........bBBBBBBBBBBTTTT......",
            "...........bBBbBBBBbBBTTT.......",
            "...........oLloooooLlo..........",
            "...........oLl.....Llo..........",
            "...........oLl.....Llo..........",
            "...........olo.....olo..........",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
        ]
    }

    # Frame 3 - back to normal
    frame3 = frame1.copy()

    # Frame 4 - slight tail wag
    frame4 = {
        'palette': palette,
        'pixels': [
            "................................",
            "................................",
            "................................",
            "...........Hh...................",
            "..........HHhh..................",
            ".........HHHhh..................",
            "........mMHHhBBBo...............",
            ".......mMMM.BBBBBBo.............",
            "......mMMM.BBBBBBBBo............",
            ".....mMMM.oBBBEeBBBo............",
            "....mMMM..oBBBBBBBBBo...........",
            "....MMM...oBBBPBBBBBBo..........",
            "...MMM....oBBBBBBBBBBBo.........",
            "...MM.....oBBBBBBBBBBBBo........",
            "..........oBBBBBBBBBBBBBo.......",
            "..........oBbBBBBBBBBBBBBo......",
            "..........obBBBBBBBBBBBBBTTT....",
            "...........bBBBBBBBBBBBB.TTT....",
            "...........bBBBBBBBBBBB..TTT....",
            "...........bBBbBBBBbBB...TT.....",
            "...........oLloooooLlo..........",
            "...........oLl.....Llo..........",
            "...........oLl.....Llo..........",
            "...........olo.....olo..........",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
        ]
    }

    return [frame1, frame2, frame3, frame4]

def get_run_frames(variant):
    """Get run animation frames"""
    palette = get_unicorn_palettes()[variant]

    frames = []

    # Frame 1 - front legs forward
    frame1 = {
        'palette': palette,
        'pixels': [
            "................................",
            "................................",
            "...........Hh...................",
            "..........HHhh..................",
            ".........HHHhh..................",
            "........mMHHhBBBo...............",
            ".......mMMM.BBBBBBo.............",
            "......mMMM.BBBBBBBBo............",
            ".....mMMM.oBBBEeBBBo............",
            "....mMMM..oBBBBBBBBBo...........",
            "....MMM...oBBBPBBBBBBo..........",
            "...MMM....oBBBBBBBBBBBo.........",
            "...MM.....oBBBBBBBBBBBBo........",
            "..........oBBBBBBBBBBBBBo.......",
            "..........obBBBBBBBBBBBBo.......",
            "...........bBBBBBBBBBBBTTTT.....",
            "...........bBBBBBBBBBBTTTT......",
            "...........bBBbBBBBbBTTTT.......",
            "..........oLl.ooooo.Lo..........",
            "..........Ll......oLLo..........",
            ".........oLl.......Llo..........",
            ".........ol.........o...........",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
        ]
    }

    # Frame 2 - legs passing
    frame2 = {
        'palette': palette,
        'pixels': [
            "................................",
            "................................",
            "..........Hh....................",
            ".........HHhh...................",
            "........HHHhh...................",
            ".......mMHHhBBBo................",
            "......mMMM.BBBBBBo..............",
            ".....mMMM.BBBBBBBBo.............",
            "....mMMM.oBBBEeBBBo.............",
            "...mMMM..oBBBBBBBBBo............",
            "...MMM...oBBBPBBBBBBo...........",
            "..MMM....oBBBBBBBBBBBo..........",
            "..MM.....oBBBBBBBBBBBBo.........",
            ".........oBBBBBBBBBBBBBo........",
            ".........obBBBBBBBBBBBBBo.......",
            "..........bBBBBBBBBBBBBTTT......",
            "..........bBBBBBBBBBBBTTTT......",
            "..........bBBbBBBBbBBTTT........",
            "..........oLLoLLoLLo............",
            "..........oLl.Ll.Llo............",
            "..........ol..ll..lo............",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
        ]
    }

    # Frame 3 - back legs forward
    frame3 = {
        'palette': palette,
        'pixels': [
            "................................",
            "...........Hh...................",
            "..........HHhh..................",
            ".........HHHhh..................",
            "........mMHHhBBBo...............",
            ".......mMMM.BBBBBBo.............",
            "......mMMM.BBBBBBBBo............",
            ".....mMMM.oBBBEeBBBo............",
            "....mMMM..oBBBBBBBBBo...........",
            "....MMM...oBBBPBBBBBBo..........",
            "...MMM....oBBBBBBBBBBBo.........",
            "...MM.....oBBBBBBBBBBBBo........",
            "..........oBBBBBBBBBBBBBo.......",
            "..........oBbBBBBBBBBBBBo.......",
            "..........obBBBBBBBBBBBBTTT.....",
            "...........bBBBBBBBBBBBTTTT.....",
            "...........bBBbBBBBbBBTTTT......",
            "............Lo.oooo.Llo.........",
            "...........oLLo.....Llo.........",
            "...........oLl.......lo.........",
            "...........ol...................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
        ]
    }

    # Frame 4 - legs stretched
    frame4 = {
        'palette': palette,
        'pixels': [
            "................................",
            "..........Hh....................",
            ".........HHhh...................",
            "........HHHhh...................",
            ".......mMHHhBBBo................",
            "......mMMM.BBBBBBo..............",
            ".....mMMM.BBBBBBBBo.............",
            "....mMMM.oBBBEeBBBo.............",
            "...mMMM..oBBBBBBBBBo............",
            "...MMM...oBBBPBBBBBBo...........",
            "..MMM....oBBBBBBBBBBBo..........",
            "..MM.....oBBBBBBBBBBBBo.........",
            ".........oBBBBBBBBBBBBBo........",
            ".........obBBBBBBBBBBBBo.TTTT...",
            "..........bBBBBBBBBBBBB.TTTT....",
            "..........bBBBBBBBBBBBBTTTT.....",
            "..........bBBbBBBBbBBBTTT.......",
            "..........oL.ooooo.LLo..........",
            ".........oLlo.......Llo.........",
            ".........Ll..........lo.........",
            "........ol......................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
        ]
    }

    # Frame 5 - similar to 2 reversed
    frame5 = {
        'palette': palette,
        'pixels': [
            "................................",
            "................................",
            "..........Hh....................",
            ".........HHhh...................",
            "........HHHhh...................",
            ".......mMHHhBBBo................",
            "......mMMM.BBBBBBo..............",
            ".....mMMM.BBBBBBBBo.............",
            "....mMMM.oBBBEeBBBo.............",
            "...mMMM..oBBBBBBBBBo............",
            "...MMM...oBBBPBBBBBBo...........",
            "..MMM....oBBBBBBBBBBBo..........",
            "..MM.....oBBBBBBBBBBBBo.........",
            ".........oBBBBBBBBBBBBBo........",
            ".........obBBBBBBBBBBBBBo.......",
            "..........bBBBBBBBBBBBBTTT......",
            "..........bBBBBBBBBBBBTTTT......",
            "..........bBBbBBBBbBBTTT........",
            "..........oLLoLLoLLo............",
            "..........oLl.Ll.Llo............",
            "..........ol..ll..lo............",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
        ]
    }

    # Frame 6 - back to frame 1 position
    frame6 = frame1.copy()

    return [frame1, frame2, frame3, frame4, frame5, frame6]

def get_jump_frames(variant):
    """Get jump animation frames"""
    palette = get_unicorn_palettes()[variant]

    # Frame 1 - crouch before jump
    frame1 = {
        'palette': palette,
        'pixels': [
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "...........Hh...................",
            "..........HHhh..................",
            ".........HHHhh..................",
            "........mMHHhBBBo...............",
            ".......mMMM.BBBBBBo.............",
            "......mMMM.BBBBBBBBo............",
            ".....mMMM.oBBBEeBBBo............",
            "....mMMM..oBBBBBBBBBo...........",
            "....MMM...oBBBPBBBBBBo..........",
            "...MMM....oBBBBBBBBBBBo.........",
            "...MM.....oBBBBBBBBBBBBo........",
            "..........oBBBBBBBBBBBBBo.......",
            "..........obBBBBBBBBBBBBo.......",
            "...........bBBBBBBBBBBTTTT......",
            "...........bBBBBBBBBBTTTT.......",
            "...........bBBbBBBbBBTTT........",
            "...........oLLoLLoLLo...........",
            "...........oLl.Ll.Llo...........",
            "...........olo.ll.olo...........",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
        ]
    }

    # Frame 2 - rising
    frame2 = {
        'palette': palette,
        'pixels': [
            "................................",
            "...........Hh...................",
            "..........HHhh..................",
            ".........HHHhh..................",
            "........mMHHhBBBo...............",
            ".......mMMM.BBBBBBo.............",
            "......mMMM.BBBBBBBBo............",
            ".....mMMM.oBBBEeBBBo............",
            "....mMMM..oBBBBBBBBBo...........",
            "....MMM...oBBBPBBBBBBo..........",
            "...MMM....oBBBBBBBBBBBo.........",
            "...MM.....oBBBBBBBBBBBBo........",
            "..........oBBBBBBBBBBBBBo.......",
            "..........obBBBBBBBBBBBBo.......",
            "...........bBBBBBBBBBBBBTTT.....",
            "...........bBBBBBBBBBBBTTTT.....",
            "...........bBBbBBBBbBBTTTT......",
            "..........oL..oooo..Lo..........",
            "..........oLl......Llo..........",
            ".........ol.........lo..........",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
        ]
    }

    # Frame 3 - peak with legs tucked
    frame3 = {
        'palette': palette,
        'pixels': [
            "...........Hh...................",
            "..........HHhh..................",
            ".........HHHhh..................",
            "........mMHHhBBBo...............",
            ".......mMMM.BBBBBBo.............",
            "......mMMM.BBBBBBBBo............",
            ".....mMMM.oBBBEeBBBo............",
            "....mMMM..oBBBBBBBBBo...........",
            "....MMM...oBBBPBBBBBBo..........",
            "...MMM....oBBBBBBBBBBBo.........",
            "...MM.....oBBBBBBBBBBBBo........",
            "..........oBBBBBBBBBBBBBo.......",
            "..........obBBBBBBBBBBBBo.TTT...",
            "...........bBBBBBBBBBBBB.TTT....",
            "...........bBBBBBBBBBBBBTTT.....",
            "...........bBBoLLoLLoBBTT.......",
            "...........oLLoLLoLLo...........",
            "..........olooloolo.............",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
        ]
    }

    # Frame 4 - falling with legs down
    frame4 = {
        'palette': palette,
        'pixels': [
            "................................",
            "...........Hh...................",
            "..........HHhh..................",
            ".........HHHhh..................",
            "........mMHHhBBBo...............",
            ".......mMMM.BBBBBBo.............",
            "......mMMM.BBBBBBBBo............",
            ".....mMMM.oBBBEeBBBo............",
            "....mMMM..oBBBBBBBBBo...........",
            "....MMM...oBBBPBBBBBBo..........",
            "...MMM....oBBBBBBBBBBBo.........",
            "...MM.....oBBBBBBBBBBBBo........",
            "..........oBBBBBBBBBBBBBo.......",
            "..........obBBBBBBBBBBBBo.......",
            "...........bBBBBBBBBBBBBTTT.....",
            "...........bBBBBBBBBBBBTTTT.....",
            "...........bBBbBBBBbBBTTTT......",
            "..........oLl.oooo.Llo..........",
            "..........oLl.....Llo...........",
            "..........oLl.....Llo...........",
            "..........ol......olo...........",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
        ]
    }

    return [frame1, frame2, frame3, frame4]

def get_attack_frames(variant):
    """Get melee attack animation frames - horn thrust"""
    palette = get_unicorn_palettes()[variant]

    # Frame 1 - wind up
    frame1 = {
        'palette': palette,
        'pixels': [
            "................................",
            "................................",
            "................................",
            "................................",
            "...........Hh...................",
            "..........HHhh..................",
            ".........HHHhh..................",
            "........mMHHhBBBo...............",
            ".......mMMM.BBBBBBo.............",
            "......mMMM.BBBBBBBBo............",
            ".....mMMM.oBBBEeBBBo............",
            "....mMMM..oBBBBBBBBBo...........",
            "....MMM...oBBBPBBBBBBo..........",
            "...MMM....oBBBBBBBBBBBo.........",
            "...MM.....oBBBBBBBBBBBBo........",
            "..........oBBBBBBBBBBBBBo.......",
            "..........obBBBBBBBBBBBBo.......",
            "...........bBBBBBBBBBBBTTT......",
            "...........bBBBBBBBBBBTTTT......",
            "...........bBBbBBBBbBBTTT.......",
            "...........oLloooooLlo..........",
            "...........oLl.....Llo..........",
            "...........oLl.....Llo..........",
            "...........olo.....olo..........",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
        ]
    }

    # Frame 2 - thrust forward (horn extended)
    frame2 = {
        'palette': palette,
        'pixels': [
            "................................",
            "................................",
            "................................",
            "................................",
            ".......HHHHHhh..................",
            "......HHHHHhh...................",
            ".....HHHHHhh....................",
            "....mMHHhBBBBo..................",
            "...mMMM.BBBBBBBo................",
            "..mMMM.BBBBBBBBBo...............",
            "..MMM.oBBBEeBBBBo...............",
            "..MM..oBBBBBBBBBBo..............",
            "......oBBBPBBBBBBBo.............",
            "......oBBBBBBBBBBBBo............",
            "......oBBBBBBBBBBBBBo...........",
            "......obBBBBBBBBBBBBo...........",
            ".......bBBBBBBBBBBBBTTT.........",
            ".......bBBBBBBBBBBBTTTT.........",
            ".......bBBbBBBBbBBTTTT..........",
            ".......oLloooooLloTTT...........",
            ".......oLl.....Llo..............",
            ".......oLl.....Llo..............",
            ".......olo.....olo..............",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
        ]
    }

    # Frame 3 - full thrust with impact effect
    frame3 = {
        'palette': palette,
        'pixels': [
            "................................",
            "................................",
            "................................",
            "....HHHHHHHHhh..................",
            "...HHHHHHHHhh...................",
            "..HHHHHHHhh.....................",
            "..mMHHhBBBBo....................",
            ".mMMM.BBBBBBBo..................",
            "mMMM.BBBBBBBBBo.................",
            "MMM.oBBBEeBBBBo.................",
            "MM..oBBBBBBBBBBo................",
            "....oBBBPBBBBBBBo...............",
            "....oBBBBBBBBBBBBo..............",
            "....oBBBBBBBBBBBBBo.............",
            "....obBBBBBBBBBBBBo.............",
            ".....bBBBBBBBBBBBBTTT...........",
            ".....bBBBBBBBBBBBTTTT...........",
            ".....bBBbBBBBbBBTTTT............",
            ".....oLloooooLloTTT.............",
            ".....oLl.....Llo................",
            ".....oLl.....Llo................",
            ".....olo.....olo................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
        ]
    }

    # Frame 4 - return
    frame4 = frame1.copy()

    return [frame1, frame2, frame3, frame4]

def get_shoot_frames(variant):
    """Get magic shooting animation - horn glows"""
    palette = get_unicorn_palettes()[variant].copy()

    # Frame 1 - charge up
    frame1 = {
        'palette': palette,
        'pixels': [
            "................................",
            "................................",
            "................................",
            "...........Hh...................",
            "..........HHhh..................",
            ".........HHHhh..................",
            "........mMHHhBBBo...............",
            ".......mMMM.BBBBBBo.............",
            "......mMMM.BBBBBBBBo............",
            ".....mMMM.oBBBEeBBBo............",
            "....mMMM..oBBBBBBBBBo...........",
            "....MMM...oBBBPBBBBBBo..........",
            "...MMM....oBBBBBBBBBBBo.........",
            "...MM.....oBBBBBBBBBBBBo........",
            "..........oBBBBBBBBBBBBBo.......",
            "..........obBBBBBBBBBBBBo.......",
            "...........bBBBBBBBBBBBTTT......",
            "...........bBBBBBBBBBBTTTT......",
            "...........bBBbBBBBbBBTTT.......",
            "...........oLloooooLlo..........",
            "...........oLl.....Llo..........",
            "...........oLl.....Llo..........",
            "...........olo.....olo..........",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
        ]
    }

    # Frame 2 - horn glow (brighter colors)
    glow_palette = palette.copy()
    glow_palette['H'] = (255, 255, 150, 255)
    glow_palette['h'] = (255, 255, 100, 255)

    frame2 = {
        'palette': glow_palette,
        'pixels': [
            "................................",
            "................................",
            "..........Hhh...................",
            ".........HHHhh..................",
            "........HHHHhh..................",
            ".......HHHHhhh..................",
            ".......mMHHhBBBo................",
            "......mMMM.BBBBBBo..............",
            ".....mMMM.BBBBBBBBo.............",
            "....mMMM.oBBBEeBBBo.............",
            "...mMMM..oBBBBBBBBBo............",
            "...MMM...oBBBPBBBBBBo...........",
            "..MMM....oBBBBBBBBBBBo..........",
            "..MM.....oBBBBBBBBBBBBo.........",
            ".........oBBBBBBBBBBBBBo........",
            ".........obBBBBBBBBBBBBo........",
            "..........bBBBBBBBBBBBTTT.......",
            "..........bBBBBBBBBBBTTTT.......",
            "..........bBBbBBBBbBBTTT........",
            "..........oLloooooLlo...........",
            "..........oLl.....Llo...........",
            "..........oLl.....Llo...........",
            "..........olo.....olo...........",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
        ]
    }

    # Frame 3 - fire! (very bright)
    bright_palette = palette.copy()
    bright_palette['H'] = (255, 255, 200, 255)
    bright_palette['h'] = (255, 255, 150, 255)

    frame3 = {
        'palette': bright_palette,
        'pixels': [
            "................................",
            "................................",
            ".........HHhh...................",
            "........HHHHhh..................",
            ".......HHHHHhh..................",
            "......HHHHHhhh..................",
            "......mMHHhBBBo.................",
            ".....mMMM.BBBBBBo...............",
            "....mMMM.BBBBBBBBo..............",
            "...mMMM.oBBBEeBBBo..............",
            "..mMMM..oBBBBBBBBBo.............",
            "..MMM...oBBBPBBBBBBo............",
            ".MMM....oBBBBBBBBBBBo...........",
            ".MM.....oBBBBBBBBBBBBo..........",
            "........oBBBBBBBBBBBBBo.........",
            "........obBBBBBBBBBBBBo.........",
            ".........bBBBBBBBBBBBTTT........",
            ".........bBBBBBBBBBBTTTT........",
            ".........bBBbBBBBbBBTTT.........",
            ".........oLloooooLlo............",
            ".........oLl.....Llo............",
            ".........oLl.....Llo............",
            ".........olo.....olo............",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
        ]
    }

    # Frame 4 - return to normal
    frame4 = frame1.copy()

    return [frame1, frame2, frame3, frame4]

def get_hurt_frame(variant):
    """Get hurt animation frame"""
    palette = get_unicorn_palettes()[variant]

    frame = {
        'palette': palette,
        'pixels': [
            "................................",
            "................................",
            "................................",
            "................................",
            "...........hH...................",
            "..........hhHH..................",
            ".........hhHHH..................",
            "........MmhhHBBBo...............",
            ".......MMMm.BBBBBBo.............",
            "......MMMm.BBBBBBBBo............",
            ".....MMMm.oBBBeEBBBo............",
            "....MMMm..oBBBBBBBBBo...........",
            "....MMM...oBBBPBBBBBBo..........",
            "...MMM....oBBBBBBBBBBBo.........",
            "...MM.....oBBBBBBBBBBBBo........",
            "..........oBBBBBBBBBBBBBo.......",
            "..........obBBBBBBBBBBBBo.......",
            "...........bBBBBBBBBBBBTTT......",
            "...........bBBBBBBBBBBTTTT......",
            "...........bBBbBBBBbBBTTT.......",
            "...........oLloooooLlo..........",
            "...........oLl.....Llo..........",
            "...........oLl.....Llo..........",
            "...........olo.....olo..........",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
        ]
    }

    return [frame]

def get_death_frames(variant):
    """Get death animation frames"""
    palette = get_unicorn_palettes()[variant]

    # Frame 1 - starting to fall
    frame1 = {
        'palette': palette,
        'pixels': [
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "...........hH...................",
            "..........hhHH..................",
            ".........hhHHH..................",
            "........MmhhHBBBo...............",
            ".......MMMm.BBBBBBo.............",
            "......MMMm.BBBBBBBBo............",
            ".....MMMm.oBBBeEBBBo............",
            "....MMMm..oBBBBBBBBBo...........",
            "....MMM...oBBBPBBBBBBo..........",
            "...MMM....oBBBBBBBBBBBo.........",
            "...MM.....oBBBBBBBBBBBBo........",
            "..........oBBBBBBBBBBBBBo.......",
            "..........obBBBBBBBBBBBBo.......",
            "...........bBBBBBBBBBBBTTT......",
            "...........bBBBBBBBBBBTTTT......",
            "...........bBBoLLoLLoBTTT.......",
            "...........oLLoLLoLLo...........",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
        ]
    }

    # Frame 2 - falling over
    frame2 = {
        'palette': palette,
        'pixels': [
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "..........hH....................",
            ".........hhHH...................",
            "........hhHHH...................",
            ".......MmhhHBBBo................",
            "......MMMm.BBBBBBo..............",
            ".....MMMm.BBBBBBBBo.............",
            "....MMMm.oBBBeEBBBo.............",
            "...MMMm..oBBBBBBBBBo............",
            "...MMM...oBBBPBBBBBBo...........",
            "..MMM....oBBBBBBBBBBBBoLLoLLoTTT",
            "..MM.....oBBBBBBBBBBBBBoLLoTTTT.",
            ".........obBBBBBBBBBBBBBoTTTT...",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
        ]
    }

    # Frame 3 - on ground
    frame3 = {
        'palette': palette,
        'pixels': [
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
            "...hH...........................",
            "..hhHH..........................",
            ".hhHHHMm........................",
            "MmhhHBBBBBBBBBBBBBBBBBBTTTTTTTT.",
            "MMMmoBBBEeBBBBBBBBBBBBBoTTTTTTT.",
            "MMMmoBBBBBBBBBBBBBBBBBBo........",
            "MMm.oBBBPBBBBBBBBBBBBBBo........",
            "Mm..obBBBBBBBBBBBBBBBBBo........",
            "....oLLoLLoLLoLLoLLoLLo.........",
            "................................",
            "................................",
            "................................",
            "................................",
            "................................",
        ]
    }

    return [frame1, frame2, frame3]

def generate_all_unicorn_sprites():
    """Generate all unicorn sprites for all variants"""
    variants = ['white', 'pink', 'rainbow']

    base_dir = "assets/player"

    for variant in variants:
        variant_dir = os.path.join(base_dir, variant)
        os.makedirs(variant_dir, exist_ok=True)

        print(f"Generating {variant} unicorn...")

        # Generate idle
        idle_frames = get_idle_frames(variant)
        for i, frame_data in enumerate(idle_frames):
            img = create_unicorn_frame(variant, frame_data)
            img.save(os.path.join(variant_dir, f"idle_{i}.png"))
        print(f"  - {len(idle_frames)} idle frames")

        # Generate run
        run_frames = get_run_frames(variant)
        for i, frame_data in enumerate(run_frames):
            img = create_unicorn_frame(variant, frame_data)
            img.save(os.path.join(variant_dir, f"run_{i}.png"))
        print(f"  - {len(run_frames)} run frames")

        # Generate jump
        jump_frames = get_jump_frames(variant)
        for i, frame_data in enumerate(jump_frames):
            img = create_unicorn_frame(variant, frame_data)
            img.save(os.path.join(variant_dir, f"jump_{i}.png"))
        print(f"  - {len(jump_frames)} jump frames")

        # Generate attack
        attack_frames = get_attack_frames(variant)
        for i, frame_data in enumerate(attack_frames):
            img = create_unicorn_frame(variant, frame_data)
            img.save(os.path.join(variant_dir, f"attack_{i}.png"))
        print(f"  - {len(attack_frames)} attack frames")

        # Generate shoot
        shoot_frames = get_shoot_frames(variant)
        for i, frame_data in enumerate(shoot_frames):
            img = create_unicorn_frame(variant, frame_data)
            img.save(os.path.join(variant_dir, f"shoot_{i}.png"))
        print(f"  - {len(shoot_frames)} shoot frames")

        # Generate hurt
        hurt_frames = get_hurt_frame(variant)
        for i, frame_data in enumerate(hurt_frames):
            img = create_unicorn_frame(variant, frame_data)
            img.save(os.path.join(variant_dir, f"hurt_{i}.png"))
        print(f"  - {len(hurt_frames)} hurt frames")

        # Generate death
        death_frames = get_death_frames(variant)
        for i, frame_data in enumerate(death_frames):
            img = create_unicorn_frame(variant, frame_data)
            img.save(os.path.join(variant_dir, f"death_{i}.png"))
        print(f"  - {len(death_frames)} death frames")

        print(f"  Done! Saved to {variant_dir}/")

if __name__ == "__main__":
    generate_all_unicorn_sprites()
    print("\nAll unicorn sprites generated successfully!")
